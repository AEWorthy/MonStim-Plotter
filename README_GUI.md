# EMG Plotter GUI User Guide

A user-friendly PyQt6-based graphical interface for creating professional EMG plots from CSV data files. Designed specifically for researchers using MonStim Analysis software, this GUI makes it easy to generate publication-quality EMG visualizations without writing code.

## Key Features

- **Intuitive Interface**: Browse and select EMG CSV files with automatic data detection
- **Flexible Plotting**: Configure all parameters through organized tabs:
  - **Basic Settings**: Recording/channel selection and overlay options
  - **Overlay Options**: Colormap selection and stimulus range customization
  - **Appearance**: Line width, figure dimensions, DPI, and transparency controls
  - **Time & Axes**: Time window cropping and axis display options
- **Real-time Preview**: See your plot before saving to ensure it meets your needs
- **Multiple Formats**: Export as PNG, SVG, or PDF for different use cases
- **Progress Feedback**: Status updates and progress tracking during plot generation
- **Non-blocking Operation**: Background processing keeps the interface responsive

## Installation

### Prerequisites
- Python 3.8 or later
- Required packages (automatically installed via pip)

### Installation Steps

1. **Install dependencies:**
   ```bash
   pip install -r requirements_gui.txt
   ```

2. **Launch the application:**
   ```bash
   python emg_plotter_gui.py
   ```

## Step-by-Step Usage Guide

1. **Load Your Data**: Click "Browse CSV File..." to select your EMG data file
   - The interface will automatically detect file format and show basic information
   - Supported format: CSV files from MonStim Analysis software

2. **Configure Plot Settings**: Use the organized tabs to customize your plot:
   - **Basic Tab**: Select specific recording and channel, or enable overlay mode
   - **Overlay Tab**: Choose colormap and set stimulus voltage range for overlay plots
   - **Appearance Tab**: Adjust visual elements like line width, figure size, and transparency
   - **Time/Axes Tab**: Set time windows for cropping and configure axis display

3. **Preview or Save**: Choose your output method:
   - **Preview Only**: Leave output file blank and click "Preview Plot"
   - **Save Plot**: Select output location and click "Generate Plot"

4. **Monitor Progress**: Watch the status log for real-time feedback and any error messages

## Understanding Your Data Format

The GUI works with CSV files containing EMG data in this structure:

| Column | Description | Example Values |
|--------|-------------|----------------|
| `recording_index` | Recording number | 0, 1, 2, 3... |
| `channel_index` | EMG channel identifier | 0, 1, 2... |
| `stimulus_V` | Stimulus voltage applied | 0.5, 1.0, 1.5... |
| `time_point` | Time in milliseconds | -10, -9, -8... |
| `amplitude_mV` | EMG signal amplitude | -2.3, 4.1, -1.8... |

This format is automatically generated by MonStim Analysis software, ensuring seamless compatibility.

## Features Overview

### Plot Types
- **Single Trace**: Plot one specific recording from one channel
- **Overlay Mode**: Plot all recordings overlaid, colored by stimulus intensity

### Customization Options
- **Colors**: Choose from various colormaps for overlay plots or specify single trace colors
- **Size**: Adjust figure dimensions and resolution (DPI)
- **Time Windows**: Crop plots to specific time ranges
- **Axes**: Hide/show axes, create separate scalable SVG axes files
- **Transparency**: Generate plots with transparent backgrounds

### Output Options
- **Formats**: PNG, SVG, PDF
- **Axes Files**: Automatic generation of separate SVG files with clean axes for use in graphics software like CorelDraw
- **Preview Mode**: View plots without saving

## Troubleshooting Common Issues

### Installation Problems

1. **"ModuleNotFoundError: No module named 'PyQt6'"**
   ```bash
   pip install PyQt6
   ```

2. **"ModuleNotFoundError: No module named 'pandas'"**
   ```bash
   pip install pandas matplotlib numpy
   ```

### Runtime Issues

3. **Application won't start**
   - Run from command line to see error messages: `python emg_plotter_gui.py`
   - Ensure all dependencies are installed: `pip install -r requirements_gui.txt`

4. **Plot generation fails**
   - Verify your CSV file has the required columns
   - Check that recording and channel indices exist in your data
   - Ensure you have write permissions to the output directory

5. **File loading errors**
   - Confirm your CSV file uses the expected format from MonStim Analysis
   - Check that the file isn't corrupted or empty

### Performance Issues

6. **Slow plot generation with large files**
   - Use time windowing to focus on specific time ranges
   - Consider using overlay mode for multiple recordings instead of individual plots

### Getting Additional Help

- Check the status log within the GUI for detailed error messages
- Verify your data format matches the expected structure
- Ensure file paths don't contain special characters that might cause issues

## Integration with MonStim Analysis

This GUI is designed to work with CSV files exported from the MonStim Analysis software. The plotting functions are based on the same core algorithms used in the main analysis package, ensuring consistent visualization.

## Technical Details

- **Framework**: PyQt6 for cross-platform GUI
- **Plotting**: matplotlib with customizable options
- **Data handling**: pandas for efficient CSV processing
- **Threading**: Background processing prevents GUI freezing during plot generation
- **File I/O**: Support for multiple image formats through matplotlib backends

## License

This project is licensed under the BSD 2-Clause License. See the main [README](README.md) and [LICENSE](LICENSE) file for details.
