# EMG Plotter GUI

A lightweight PyQt6-based graphical user interface for plotting EMG traces from CSV data files generated by the MonStim Analysis software.

## Features

- **Easy File Selection**: Browse and select EMG CSV files with automatic file information detection
- **Flexible Plot Options**: Configure all plotting parameters through an intuitive tabbed interface:
  - Basic settings (recording index, channel index, overlay mode)
  - Overlay options (stimulus column, colormap, color range)
  - Appearance settings (line width, figure size, DPI, transparency)
  - Time window and axes options
- **Live Preview**: Preview plots before saving
- **Multiple Output Formats**: Save plots as PNG, SVG, or PDF
- **Progress Tracking**: Real-time status updates and progress indication
- **Background Processing**: Non-blocking plot generation using worker threads

## Installation

### Prerequisites
- Python 3.8 or later
- Required packages (see requirements_gui.txt)

### Quick Start

1. **Install dependencies:**
   ```bash
   pip install -r requirements_gui.txt
   ```

2. **Run the GUI:**
   - **Windows**: Double-click `run_gui.bat` or run `python emg_plotter_gui.py`
   - **Mac/Linux**: Run `python emg_plotter_gui.py`

## Usage

1. **Select CSV File**: Click "Browse CSV File..." to select your EMG data file
2. **Configure Options**: Use the tabbed interface to set your plotting preferences:
   - **Basic**: Choose recording/channel index, enable overlay mode
   - **Overlay**: Configure colormap and stimulus range for overlay plots
   - **Appearance**: Adjust line width, figure size, and visual settings
   - **Time/Axes**: Set time windows and axis options
3. **Choose Output** (optional): Select an output file to save the plot, or leave blank to just preview
4. **Generate Plot**: Click "Preview Plot" to see the result, or "Generate Plot" to save

## CSV File Format

The GUI expects CSV files with the following columns:
- `recording_index`: Index of the recording (0, 1, 2, ...)
- `channel_index`: EMG channel index (0, 1, 2, ...)
- `stimulus_V`: Stimulus voltage for each recording
- `time_point`: Time points in milliseconds
- `amplitude_mV`: EMG amplitude in millivolts

This format is automatically generated by the MonStim Analysis software.

## Features Overview

### Plot Types
- **Single Trace**: Plot one specific recording from one channel
- **Overlay Mode**: Plot all recordings overlaid, colored by stimulus intensity

### Customization Options
- **Colors**: Choose from various colormaps for overlay plots or specify single trace colors
- **Size**: Adjust figure dimensions and resolution (DPI)
- **Time Windows**: Crop plots to specific time ranges
- **Axes**: Hide/show axes, create separate scalable SVG axes files
- **Transparency**: Generate plots with transparent backgrounds

### Output Options
- **Formats**: PNG, SVG, PDF
- **Axes Files**: Automatic generation of separate SVG files with clean axes for use in graphics software like CorelDraw
- **Preview Mode**: View plots without saving

## Troubleshooting

### Common Issues

1. **"Import PyQt6 could not be resolved"**
   - Install PyQt6: `pip install PyQt6`

2. **"Import pandas could not be resolved"**
   - Install pandas: `pip install pandas`

3. **Plot generation errors**
   - Check that your CSV file has the required columns
   - Verify the recording and channel indices exist in your data
   - Check file permissions for output directory

4. **GUI doesn't start on Windows**
   - Try running from command prompt: `python emg_plotter_gui.py`
   - Check that Python is in your PATH

### Getting Help

If you encounter issues:
1. Check that all dependencies are installed correctly
2. Verify your CSV file format matches the expected structure
3. Check the status log in the GUI for detailed error messages

## Integration with MonStim Analysis

This GUI is designed to work with CSV files exported from the MonStim Analysis software. The plotting functions are based on the same core algorithms used in the main analysis package, ensuring consistent visualization.

## Technical Details

- **Framework**: PyQt6 for cross-platform GUI
- **Plotting**: matplotlib with customizable options
- **Data handling**: pandas for efficient CSV processing
- **Threading**: Background processing prevents GUI freezing during plot generation
- **File I/O**: Support for multiple image formats through matplotlib backends

## License

This project is part of the Pretty-EMG visualization toolkit. See the main project repository for licensing information.
