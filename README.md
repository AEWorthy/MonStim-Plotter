# MonStim Plotter - EMG Data Visualization Toolkit

A user-friendly toolkit for creating publication-quality plots of electromyography (EMG) data. Designed specifically for researchers working with MonStim Analysis software outputs, this toolkit provides both an intuitive graphical interface and powerful command-line tools for generating professional EMG visualizations.

## License

This project is licensed under the BSD 2-Clause License - see the [LICENSE](LICENSE) file for details. 

**Academic Use**: When using this software in academic publications, please consider citing the repository and any relevant papers.

## Quick Start

### GUI Version (Recommended for most users)
1. **Install dependencies:** `pip install -r requirements_gui.txt`
2. **Run GUI:** `python emg_plotter_gui.py`

### Command Line Version
```bash
python plot_emg.py your_data.csv --overlay --output result.png
```

## Features

### Core Plotting Capabilities
- **Single Trace Plots**: Plot individual EMG recordings
- **Overlay Plots**: Display multiple recordings with stimulus-based coloring
- **Time Windowing**: Crop plots to specific time ranges
- **Multiple Output Formats**: PNG, SVG, PDF support
- **Scalable Graphics**: Auto-generated SVG axes for use in CorelDraw/Illustrator

### User Interfaces
- **Graphical Interface**: PyQt6-based GUI with intuitive controls
- **Command Line**: Full-featured CLI with extensive options
- **Programmatic**: Import as Python module for custom workflows

### Customization Options
- **Colors**: Extensive colormap support and custom color options
- **Styling**: Line width, transparency, figure size, DPI control
- **Axes**: Show/hide axes, custom scale bars, clean backgrounds
- **Data Processing**: Fixed Y-axis scaling, stimulus range filtering

## File Structure

```
MonStim-Plotter/
├── plot_emg.py              # Core plotting functions and CLI
├── emg_plotter_gui.py       # PyQt6 GUI application
├── launcher.py              # Entry point for executable builds
├── requirements_gui.txt     # Python dependencies for GUI
├── requirements_build.txt   # Dependencies for building executable
├── example_usage.py         # Code examples and usage demonstrations
├── build_exe.ps1           # PowerShell script for building executable
├── emg_plotter.spec        # PyInstaller specification file
├── Example Data 1.csv      # Sample EMG data file
├── Example Data 2.csv      # Sample EMG data file
├── Example Data 3.csv      # Sample EMG data file
├── README_GUI.md           # GUI-specific documentation
├── README_BUILD.md         # Executable building instructions
└── src/                    # Resources and assets
    ├── icon.ico            # Windows icon
    ├── icon.png            # Application icon
    └── logo.png            # Project logo
```

## Installation

### Option 1: Quick Setup (Recommended)
```bash
pip install -r requirements_gui.txt
```

### Option 2: Manual Installation
```bash
pip install PyQt6 pandas matplotlib numpy
```

## Usage

### GUI Application

1. **Launch GUI:**
   - Run: `python emg_plotter_gui.py`

2. **Select Data:** Browse for your EMG CSV file using the "Browse CSV File..." button

3. **Configure Options:** Use the tabbed interface to customize your plot:
   - **Basic tab:** Select recording and channel, enable overlay mode
   - **Overlay tab:** Choose colormap and stimulus range for overlay plots
   - **Appearance tab:** Adjust figure size, line width, colors, and transparency
   - **Time/Axes tab:** Set time windows and axis display options

4. **Generate Plot:** Click "Preview Plot" to view or "Generate Plot" to save your visualization

### Command Line Interface

```bash
# Single recording plot
python plot_emg.py data.csv -r 0 -c 1 --color red -o single.png

# Overlay all recordings with colormap
python plot_emg.py data.csv --overlay --cmap inferno --show-colorbar -o overlay.png

# Cropped time window with custom styling
python plot_emg.py data.csv -r 5 --tmin -5 --tmax 60 --linewidth 2 -o cropped.png

# Publication-ready with separate axes
python plot_emg.py data.csv --overlay --figsize 12 6 --dpi 300 --create-axes -o publication.png
```

### Programmatic Usage

```python
from plot_emg import plot_emg_trace

# Basic usage
plot_emg_trace('data.csv', recording_index=0, channel_index=1, output_file='result.png')

# Advanced overlay plot
plot_emg_trace(
    'data.csv',
    overlay=True,
    cmap_name='inferno',
    show_colorbar=True,
    figsize=(12, 6),
    output_file='overlay.png'
)
```

## Data Format

Expected CSV format (generated by and exported from 'MonStim Analyzer' software):

| Column | Description |
|--------|-------------|
| `recording_index` | Recording number (0, 1, 2, ...) |
| `channel_index` | EMG channel (0, 1, 2, ...) |
| `stimulus_V` | Stimulus voltage |
| `time_point` | Time in milliseconds |
| `amplitude_mV` | EMG amplitude in millivolts |

## Customization Examples

### Color Schemes
```bash
# Warm colors for overlay
python plot_emg.py data.csv --overlay --cmap plasma

# Cool monochrome
python plot_emg.py data.csv --overlay --cmap inferno_r

# Custom single trace color
python plot_emg.py data.csv --color "#FF6B35"
```

### Publication Graphics
```bash
# High-resolution with separate axes
python plot_emg.py data.csv --overlay --figsize 8 6 --dpi 600 --create-axes

# Transparent background for presentations
python plot_emg.py data.csv --overlay --transparent --hide-axes
```

### Time Windows
```bash
# Focus on response period
python plot_emg.py data.csv --tmin -5 --tmax 100

# Multiple time windows (batch processing)
for start in -5 0 5; do
    python plot_emg.py data.csv --tmin $start --tmax $((start+50)) -o window_${start}ms.png
done
```

## Advanced Features

### Batch Processing
```python
import pandas as pd
from plot_emg import plot_emg_trace

# Process all recordings
df = pd.read_csv('data.csv')
recordings = df['recording_index'].unique()

for rec in recordings:
    plot_emg_trace(
        'data.csv',
        recording_index=rec,
        output_file=f'recording_{rec:03d}.png'
    )
```

### Custom Styling
```python
# Publication-ready styling
plot_emg_trace(
    'data.csv',
    overlay=True,
    cmap_name='viridis',
    figsize=(10, 6),
    dpi=300,
    linewidth=1.0,
    transparent=True,
    create_axes=True
)
```

## Troubleshooting

### Common Issues

1. **"ModuleNotFoundError: No module named 'PyQt6'"**
   ```bash
   pip install PyQt6
   ```

2. **"No module named 'plot_emg'"**
   - Ensure you're running the command from the project directory
   - Check that `plot_emg.py` exists in the current directory

3. **GUI doesn't start**
   - Verify all dependencies are installed: `pip install -r requirements_gui.txt`
   - Try running from command line to see error messages

4. **Plotting errors with large files**
   - Use time windowing options to reduce data size
   - Consider processing data in smaller chunks

### Getting Help

- Check `example_usage.py` for comprehensive code examples
- See [GUI Documentation](README_GUI.md) for GUI-specific help
- Use `python plot_emg.py --help` for complete CLI options

## Integration

### With MonStim Analyzer
This toolkit seamlessly integrates with CSV files exported from MonStim Analysis software, providing a complete workflow from data acquisition to publication-ready figures.

### With Graphics Software
- **Vector Graphics:** SVG output works directly with Adobe Illustrator, CorelDRAW, and Inkscape
- **Publications:** High-DPI PNG files meet journal requirements
- **Presentations:** Transparent background options for slides and posters

### With Research Workflows
- **Python Integration:** Import as a module for custom analysis pipelines
- **Batch Processing:** Command-line interface supports automated workflows
- **Jupyter Compatibility:** Works seamlessly in notebook environments

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details. 

**Academic Use**: When using this software in academic publications, please consider citing the repository and any relevant papers.

## Contributing

We welcome contributions! This project aims to remain lightweight and focused on EMG visualization. 

- **Bug Reports**: Open an issue with detailed reproduction steps
- **Feature Requests**: Describe your use case and expected behavior  
- **Code Contributions**: See [CONTRIBUTING.md](CONTRIBUTING.md) for development guidelines
- **Documentation**: Help improve clarity and add examples

For questions and discussions, please use GitHub Issues or Discussions.

---

**Additional Resources:**
- [GUI User Guide](README_GUI.md) - Comprehensive GUI documentation
- [Build Instructions](README_BUILD.md) - Creating standalone executables
- [Code Examples](example_usage.py) - Programming examples and tutorials
