# Pretty EMG - EMG Data Visualization Toolkit

A comprehensive toolkit for creating publication-quality plots of electromyography (EMG) data, featuring both command-line and graphical user interface options.

## üöÄ Quick Start

### GUI Version (Recommended for most users)
1. **Install dependencies:** `pip install -r requirements_gui.txt`
2. **Run GUI:** `python emg_plotter_gui.py` or double-click `run_gui.bat` (Windows)

### Command Line Version
```bash
python plot_emg.py your_data.csv --overlay --output result.png
```

## üìä Features

### Core Plotting Capabilities
- **Single Trace Plots**: Plot individual EMG recordings
- **Overlay Plots**: Display multiple recordings with stimulus-based coloring
- **Time Windowing**: Crop plots to specific time ranges
- **Multiple Output Formats**: PNG, SVG, PDF support
- **Scalable Graphics**: Auto-generated SVG axes for use in CorelDraw/Illustrator

### User Interfaces
- **Graphical Interface**: PyQt6-based GUI with intuitive controls
- **Command Line**: Full-featured CLI with extensive options
- **Programmatic**: Import as Python module for custom workflows

### Customization Options
- **Colors**: Extensive colormap support and custom color options
- **Styling**: Line width, transparency, figure size, DPI control
- **Axes**: Show/hide axes, custom scale bars, clean backgrounds
- **Data Processing**: Fixed Y-axis scaling, stimulus range filtering

## üìÅ File Structure

```
Pretty-EMG/
‚îú‚îÄ‚îÄ plot_emg.py              # Core plotting functions
‚îú‚îÄ‚îÄ emg_plotter_gui.py       # PyQt6 GUI application
‚îú‚îÄ‚îÄ requirements_gui.txt     # Python dependencies
‚îú‚îÄ‚îÄ run_gui.bat             # Windows launcher
‚îú‚îÄ‚îÄ run_gui.sh              # Unix launcher
‚îú‚îÄ‚îÄ demo_gui.py             # Interactive demo
‚îú‚îÄ‚îÄ setup_gui.py            # Installation helper
‚îú‚îÄ‚îÄ example_usage.py        # Usage examples
‚îú‚îÄ‚îÄ README_GUI.md           # GUI-specific documentation
‚îî‚îÄ‚îÄ output/                 # Generated plots
```

## üõ†Ô∏è Installation

### Option 1: Quick Setup (Recommended)
```bash
python setup_gui.py
```

### Option 2: Manual Installation
```bash
pip install PyQt6 pandas matplotlib numpy
```

### Option 3: From Requirements File
```bash
pip install -r requirements_gui.txt
```

## üìñ Usage

### GUI Application

1. **Launch GUI:**
   - Windows: Double-click `run_gui.bat`
   - Mac/Linux: Run `./run_gui.sh`
   - Any platform: `python emg_plotter_gui.py`

2. **Select Data:** Browse for your EMG CSV file

3. **Configure Options:** Use the tabbed interface to set:
   - Basic settings (recording/channel selection)
   - Overlay options (colormap, stimulus range)
   - Appearance (size, colors, line width)
   - Time windows and axes options

4. **Generate Plot:** Preview or save your visualization

### Command Line Interface

```bash
# Single recording plot
python plot_emg.py data.csv -r 0 -c 1 --color red -o single.png

# Overlay all recordings with colormap
python plot_emg.py data.csv --overlay --cmap inferno --show-colorbar -o overlay.png

# Cropped time window with custom styling
python plot_emg.py data.csv -r 5 --tmin -5 --tmax 60 --linewidth 2 -o cropped.png

# Publication-ready with separate axes
python plot_emg.py data.csv --overlay --figsize 12 6 --dpi 300 --create-axes -o publication.png
```

### Programmatic Usage

```python
from plot_emg import plot_emg_trace

# Basic usage
plot_emg_trace('data.csv', recording_index=0, channel_index=1, output_file='result.png')

# Advanced overlay plot
plot_emg_trace(
    'data.csv',
    overlay=True,
    cmap_name='inferno',
    show_colorbar=True,
    figsize=(12, 6),
    output_file='overlay.png'
)
```

## üìä Data Format

Expected CSV format (generated by MonStim Analysis software):

| Column | Description |
|--------|-------------|
| `recording_index` | Recording number (0, 1, 2, ...) |
| `channel_index` | EMG channel (0, 1, 2, ...) |
| `stimulus_V` | Stimulus voltage |
| `time_point` | Time in milliseconds |
| `amplitude_mV` | EMG amplitude in millivolts |

## üé® Customization Examples

### Color Schemes
```bash
# Warm colors for overlay
python plot_emg.py data.csv --overlay --cmap plasma

# Cool monochrome
python plot_emg.py data.csv --overlay --cmap inferno_r

# Custom single trace color
python plot_emg.py data.csv --color "#FF6B35"
```

### Publication Graphics
```bash
# High-resolution with separate axes
python plot_emg.py data.csv --overlay --figsize 8 6 --dpi 600 --create-axes

# Transparent background for presentations
python plot_emg.py data.csv --overlay --transparent --hide-axes
```

### Time Windows
```bash
# Focus on response period
python plot_emg.py data.csv --tmin -5 --tmax 100

# Multiple time windows (batch processing)
for start in -5 0 5; do
    python plot_emg.py data.csv --tmin $start --tmax $((start+50)) -o window_${start}ms.png
done
```

## üîß Advanced Features

### Batch Processing
```python
import pandas as pd
from plot_emg import plot_emg_trace

# Process all recordings
df = pd.read_csv('data.csv')
recordings = df['recording_index'].unique()

for rec in recordings:
    plot_emg_trace(
        'data.csv',
        recording_index=rec,
        output_file=f'recording_{rec:03d}.png'
    )
```

### Custom Styling
```python
# Publication-ready styling
plot_emg_trace(
    'data.csv',
    overlay=True,
    cmap_name='viridis',
    figsize=(10, 6),
    dpi=300,
    linewidth=1.0,
    transparent=True,
    create_axes=True
)
```

## üêõ Troubleshooting

### Common Issues

1. **"Import PyQt6 could not be resolved"**
   ```bash
   pip install PyQt6
   ```

2. **"No module named 'plot_emg'"**
   - Ensure you're in the correct directory
   - Check that `plot_emg.py` exists

3. **Matplotlib threading warnings**
   - Use GUI for interactive plotting
   - Set output file for command-line batch processing

4. **Memory issues with large files**
   - Process data in chunks
   - Use time windowing to reduce data size

### Getting Help

- Run `python demo_gui.py` for interactive demo
- Check `example_usage.py` for code examples
- See `README_GUI.md` for GUI-specific help
- Use `python plot_emg.py --help` for CLI options

## üîó Integration

### With MonStim Analysis
This toolkit is designed to work with CSV files exported from the MonStim Analysis software, providing a streamlined workflow from data acquisition to publication-ready figures.

### With Graphics Software
- SVG axes files work directly in CorelDraw, Illustrator
- High-DPI PNG files suitable for publications
- Transparent backgrounds for presentations

### With Python Workflows
- Import as module for custom analysis pipelines
- Integrate with Jupyter notebooks
- Extend with additional matplotlib customizations

## üìÑ License

Part of the MonStim Analysis ecosystem. See main project for licensing details.

## ü§ù Contributing

This project is designed to be lightweight and focused. For feature requests or bug reports, please reference the main MonStim Analysis repository.

---

**Quick Links:**
- [GUI Documentation](README_GUI.md)
- [Usage Examples](example_usage.py)
- [Interactive Demo](demo_gui.py)
- [MonStim Analysis](../MonStim_Analysis)
Plots pretty EMG graphs for decorating PPTs
